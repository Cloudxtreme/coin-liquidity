<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title th:text="'Liquidity Summary - ' + ${baseCurrency} + ' (last ' + ${days} + ' days)'">Liquidity</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://code.highcharts.com/stock/highstock.js"></script>

    <script type="text/javascript" src="https://coinliquidity.com/js/dropdown.js"></script>
    <link rel="stylesheet" href="https://coinliquidity.com/css/dropdown.css" type="text/css" media="all"/>
</head>
<body>

<div class="dropdown">
    <button onclick="showCcyDropdown()" class="dropbtn">Currencies</button>
    <div id="ccyDropdown" class="dropdown-content">
        <a th:each="currency : ${currencies}"
           th:href="@{/liquidity/view/summary/{ccy}(ccy=${currency},days=${days},exchange=${exchange})}"
           th:text="${currency}">BTC</a>
    </div>
</div>

<div id="container" style="width:100%; height:400px;"></div>
<script th:inline="javascript">
/*<![CDATA[*/
var baseCurrency = /*[[${baseCurrency}]]*/ 'BTC';
var days = /*[[${days}]]*/ 10;
var url = /*[[@{/liquidity/data/summary/{ccy}(ccy=${baseCurrency},days=${days},exchange=${exchange})}]]*/ 'xyz';
/*]]>*/

// colors
var bidColor = 'Green'
var askColor = 'Red'
var priceColor = 'LightGray'

$(document).ready(function () {
    var options = {
        chart: {
            renderTo: 'container',
            type: 'line'
        },
        title: {
            text: 'Liquidity Summary - ' + baseCurrency + ' (last ' + days + ' days)'
        },
        yAxis: [
            {
                opposite: false,
                title: {
                    text: 'Total Bids (USD)',
                    style: {
                        color: bidColor
                    }
                }
            },
            {
                opposite: true,
                title: {
                    text: 'Total Asks',
                    style: {
                        color: askColor
                    }
                }
            },
            {
                opposite: true,
                title: {
                    text: 'Price',
                    style: {
                        color: priceColor
                    }
                }
            }
        ],
        series: [
            {
                yAxis: 0,
                name: 'Total Bids (USD)',
                color: bidColor
            },
            {
                yAxis: 1,
                name: 'Total Asks',
                color: askColor
            },
            {
                yAxis: 2,
                name: 'Price',
                color: priceColor
            }
        ]
    };

    $.getJSON(url, function(data) {
        options.series[0].data = data['bids'];
        options.series[1].data = data['asks'];
        options.series[2].data = data['price'];
        new Highcharts.StockChart(options);
    });
});


</script>
</body>
</html>